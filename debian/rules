#!/usr/bin/make -f

export LC_ALL=C.UTF-8

export PG_CTL := $(lastword $(sort $(wildcard /usr/lib/postgresql/*/bin/pg_ctl)))
export PYBUILD_NAME=swh.scheduler
export PYBUILD_TEST_ARGS= --postgresql-exec $(PG_CTL) -m 'not db and not fs' \
	-p no:pytest_swh_scheduler

%:
	dh $@ --with python3 --buildsystem=pybuild

override_dh_install:
	dh_install
	rm -v $(CURDIR)/debian/python3-*/usr/lib/python*/dist-packages/swh/__init__.py
	rm -rf $(CURDIR)/debian/python3-*/usr/lib/python*/dist-packages/.hypothesis
